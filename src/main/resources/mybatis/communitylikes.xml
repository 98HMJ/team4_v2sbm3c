<?xml version="1.0" encoding="UTF-8"?>
 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="dev.mvc.like.community.CommunityLikesDAOInter">
  
  <!-- 커뮤니티 글 등록시 - 커뮤니티 좋아요 생성-->
  <insert id="create" parameterType="dev.mvc.like.community.CommunityLikesVO">
    INSERT INTO communitylikes(communitylikesno, cnt, communityno, memberno)
    VALUES(communitylikes_seq.nextval, 0, #{communityno}, #{memberno})
  </insert>
  
  <!-- 커뮤니티 글의 좋아요 수 -->
   <select id="count_by_communityno" resultType="int" parameterType="int">
      SELECT COUNT(*) as cnt 
      FROM communitylikes
      WHERE communityno = #{communityno}
   </select>
  
  <!-- 커뮤니티 글의 좋아요 수 증가 -->
  <update id="update_cnt_plus" parameterType="Integer">
    UPDATE communitylikes
    SET cnt = cnt + 1
    WHERE communityno = #{communityno}
  </update>

  <!-- 커뮤니티 글의 좋아요 수 감소 -->
  <update id="update_cnt_minus" parameterType="Integer">
    UPDATE communitylikes
    SET cnt = cnt - 1
    WHERE communityno = #{communityno} AND cnt > 0
  </update>
   
</mapper> 