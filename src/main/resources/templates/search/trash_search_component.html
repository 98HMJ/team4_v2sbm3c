<!-- 검색 컨테이너 -->
<div th:fragment="trash_search_fragment">
  <div style="margin-bottom: 40px; position: relative;">
    <div style="display: flex; justify-content: center;">
      <div class="search">
        <img src="/images/ic_search.svg">
        <input type="text" id="search-box" placeholder="예) 형광등, 고추장 ">
        <div id="results" style="position: absolute; top: 100%; width: 100%; z-index: 2;
                                 margin-top: 5px; max-height: 200px; overflow-y: auto;
                                 border-radius: 10px; background-color: #f9f9f9; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);"></div>
        <script>
          document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('search-box').addEventListener('input', function () {
              let query = this.value;
              if (query.length > 0) {
                fetch('/trash_linked/trash_list_search?word=' + encodeURIComponent(query))
                  .then(response => response.json())
                  .then(data => {
                    const results = document.getElementById('results');
                    results.innerHTML = '';
                    results.style.display = 'block';
                    data.forEach(item => {
                      const resultItem = document.createElement('div');
                      resultItem.className = 'result-item';
                      resultItem.dataset.id = item.trashno;
                      resultItem.innerHTML = `
                                    <img src="/trash/storage/${item.thumb1}">
                                    <span>${item.name}</span>
                                `;
                      results.appendChild(resultItem);
                    });
                  });
              } else {
                document.getElementById('results').style.display = 'none';
              }
            });

            document.getElementById('results').addEventListener('click', function (event) {
              if (event.target.closest('.result-item')) {
                const trashId = event.target.closest('.result-item').dataset.id;
                window.location.href = `/trash/trash_read?trashno=${trashId}`;
              }
            });
          });
        </script>
      </div>
    </div>
  </div>
</div>
